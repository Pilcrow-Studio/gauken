<script setup lang="ts">
import { useRoute } from "vue-router";

const route = useRoute();

const isHome = computed(() => route.path === "/");

const prismic = usePrismic();
const { data: art_pieces } = await useLazyAsyncData("art_pieces_count", () =>
  prismic.client.getAllByType("art_piece")
);
const art_piece_count = art_pieces.value?.length ?? 0;

provide("art_piece_count", art_piece_count);

const random_art_piece = computed(() => {
  return art_pieces.value?.[
    Math.floor(Math.random() * art_pieces.value.length)
  ];
});
</script>

<template>
  <div class="flex flex-col z-[9999] max-w-fit">
    <NuxtLink to="/" class="mb-10 w-[50vw] max-w-[600px]" aria-label="Gauken">
      <svg
        width="100%"
        viewBox="0 0 510 91"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M42.8396 90.4519C28.8476 90.4519 18.2876 86.5799 11.1596 78.8359C4.11961 71.0039 0.599609 60.0479 0.599609 45.9679C0.599609 36.1999 2.44761 27.9719 6.14361 21.2839C9.92761 14.5079 15.0316 9.40389 21.4556 5.9719C27.9676 2.4519 35.3596 0.691895 43.6316 0.691895C48.4716 0.691895 52.2996 1.08789 55.1156 1.87989C58.0196 2.6719 60.2636 3.4639 61.8476 4.2559C63.5196 5.0479 64.8836 5.4439 65.9396 5.4439C67.0836 5.4439 67.9196 5.0039 68.4476 4.1239C69.0636 3.24389 69.8116 2.09989 70.6916 0.691895H74.5196V30.9199H70.0316C68.5356 22.1199 65.5436 15.8279 61.0556 12.0439C56.5676 8.25989 50.8036 6.36789 43.7636 6.36789C34.4356 6.36789 27.1756 9.79989 21.9836 16.6639C16.8796 23.4399 14.3276 32.6799 14.3276 44.3839C14.3276 57.8479 17.0116 67.9239 22.3796 74.6119C27.8356 81.2119 35.2716 84.5119 44.6876 84.5119C48.8236 84.5119 52.2996 83.8959 55.1156 82.6639C58.0196 81.4319 60.7916 79.8479 63.4316 77.9119V63.6559C63.4316 60.4879 63.1676 58.1119 62.6396 56.5279C62.1116 54.8559 61.0116 53.7559 59.3396 53.2279C57.6676 52.6119 55.1596 52.3039 51.8156 52.3039V48.0799H84.4196V52.3039C80.7236 52.3039 78.3036 52.9639 77.1596 54.2839C76.0156 55.5159 75.4436 58.1999 75.4436 62.3359V81.4759C70.6916 84.2039 65.8956 86.4039 61.0556 88.0759C56.2156 89.6599 50.1436 90.4519 42.8396 90.4519Z"
          fill="currentColor"
        />
        <path
          d="M108.57 88.9999H80.8504V85.0399C83.3144 85.0399 85.2945 84.6439 86.7905 83.8519C88.2865 83.0599 89.7385 81.4759 91.1465 79.0999C92.5545 76.6359 94.3145 72.8959 96.4265 67.8799L124.41 1.61589H129.822L161.106 73.2919C163.042 77.6039 164.89 80.6399 166.65 82.3999C168.498 84.1599 171.182 85.0399 174.702 85.0399V88.9999H139.194V85.0399C140.514 85.0399 141.878 84.9519 143.286 84.7759C144.694 84.5999 145.882 84.1599 146.85 83.4559C147.818 82.7519 148.302 81.6519 148.302 80.1559C148.302 79.1879 148.126 78.0879 147.774 76.8559C147.51 75.5359 146.938 73.9079 146.058 71.9719L140.382 58.7719L139.458 56.1319L124.41 17.8519H124.014L108.57 56.1319L107.646 58.7719L101.178 74.0839C100.826 75.1399 100.474 76.1959 100.122 77.2519C99.8585 78.2199 99.7265 79.3199 99.7265 80.5519C99.7265 82.3999 100.43 83.6319 101.838 84.2479C103.246 84.7759 105.49 85.0399 108.57 85.0399V88.9999ZM142.362 60.0919H105.666L107.646 54.8119H140.382L142.362 60.0919Z"
          fill="currentColor"
        />
        <path
          d="M211.247 90.5839C199.543 90.5839 191.007 87.8999 185.639 82.5319C180.271 77.0759 177.587 68.2319 177.587 55.9999V17.8519C177.587 14.7719 177.235 12.3959 176.531 10.7239C175.827 9.05189 174.551 7.90789 172.703 7.2919C170.855 6.58789 168.171 6.23589 164.651 6.23589V2.2759H202.667V6.23589C198.971 6.23589 196.199 6.58789 194.351 7.2919C192.503 7.90789 191.271 9.09589 190.655 10.8559C190.039 12.6159 189.731 15.1679 189.731 18.5119V55.8679C189.731 61.5879 190.479 66.4279 191.975 70.3879C193.471 74.2599 196.023 77.2079 199.631 79.2319C203.327 81.2559 208.299 82.2679 214.547 82.2679C223.171 82.2679 229.375 80.2439 233.159 76.1959C237.031 72.0599 238.967 65.4599 238.967 56.3959V23.1319C238.967 18.4679 238.703 14.9479 238.175 12.5719C237.647 10.1079 236.503 8.43589 234.743 7.55589C232.983 6.67589 230.255 6.23589 226.559 6.23589V2.2759H258.899V6.23589C255.115 6.23589 252.343 6.67589 250.583 7.55589C248.823 8.43589 247.679 10.0639 247.151 12.4399C246.711 14.7279 246.491 18.1599 246.491 22.7359V54.5479C246.491 66.5159 243.719 75.5359 238.175 81.6079C232.719 87.5919 223.743 90.5839 211.247 90.5839Z"
          fill="currentColor"
        />
        <path
          d="M296.513 88.9999H258.497V85.0399C262.545 85.0399 265.449 84.7319 267.209 84.1159C269.057 83.4999 270.245 82.2679 270.773 80.4199C271.301 78.4839 271.565 75.5799 271.565 71.7079V19.6999C271.565 16.2679 271.345 13.5839 270.905 11.6479C270.465 9.62389 269.321 8.21589 267.473 7.42389C265.713 6.63189 262.721 6.23589 258.497 6.23589V2.2759H296.513V6.23589C292.377 6.23589 289.385 6.63189 287.537 7.42389C285.689 8.21589 284.545 9.62389 284.105 11.6479C283.753 13.5839 283.577 16.2679 283.577 19.6999V44.5159H284.237L305.621 23.6599C308.701 20.7559 311.033 18.2919 312.617 16.2679C314.201 14.2439 314.993 12.2639 314.993 10.3279C314.993 8.91989 314.597 7.90789 313.805 7.2919C313.101 6.58789 311.825 6.23589 309.977 6.23589H307.865V2.2759H340.205V6.23589C337.741 6.32389 335.629 6.67589 333.869 7.2919C332.197 7.90789 330.525 8.87589 328.853 10.1959C327.269 11.4279 325.289 13.1439 322.913 15.3439L294.269 42.1399L332.153 79.3639C334.353 81.3879 336.377 82.8399 338.225 83.7199C340.073 84.5999 342.625 85.0399 345.881 85.0399V88.9999H307.733V85.0399H310.373C312.221 85.0399 313.541 84.8639 314.333 84.5119C315.125 84.0719 315.521 83.3679 315.521 82.3999C315.521 80.9039 314.861 79.2319 313.541 77.3839C312.221 75.5359 310.153 73.2039 307.337 70.3879C304.521 67.4839 300.869 63.8759 296.381 59.5639L284.765 47.9479H283.577V71.7079C283.577 75.4039 283.841 78.2199 284.369 80.1559C284.897 82.0039 286.085 83.2799 287.933 83.9839C289.781 84.6879 292.641 85.0399 296.513 85.0399V88.9999Z"
          fill="currentColor"
        />
        <path
          d="M414.672 88.9999H344.184V85.0399C347.792 85.0399 350.476 84.8199 352.236 84.3799C354.084 83.8519 355.316 82.7519 355.932 81.0799C356.636 79.4079 356.988 76.8559 356.988 73.4239V18.3799C356.988 15.0359 356.636 12.4839 355.932 10.7239C355.316 8.96389 354.084 7.7759 352.236 7.1599C350.476 6.5439 347.792 6.23589 344.184 6.23589V2.2759H413.484L414.276 23.9239H410.052C409.436 19.5239 408.468 16.2239 407.148 14.0239C405.916 11.7359 403.848 10.1959 400.944 9.40389C398.128 8.61189 393.992 8.21589 388.536 8.21589H369.132V41.7439H384.576C388.624 41.7439 391.704 41.3919 393.816 40.6879C395.928 39.9839 397.38 38.6639 398.172 36.7279C398.964 34.7919 399.36 32.0639 399.36 28.5439H403.584V59.1679H399.36C399.36 55.5599 398.964 52.8759 398.172 51.1159C397.38 49.3559 395.928 48.2119 393.816 47.6839C391.704 47.1559 388.624 46.8919 384.576 46.8919H369.132V83.1919H386.16C391.264 83.1919 395.356 82.9719 398.436 82.5319C401.604 82.0039 404.068 81.0799 405.828 79.7599C407.676 78.4399 409.172 76.5479 410.316 74.0839C411.548 71.6199 412.824 68.4079 414.144 64.4479H418.368L414.672 88.9999Z"
          fill="currentColor"
        />
        <path
          d="M497.169 90.0559H492.813L438.165 19.4359H434.469L432.093 14.2879C430.421 11.9999 428.925 10.2839 427.605 9.1399C426.373 7.9959 425.053 7.24789 423.645 6.89589C422.325 6.45589 420.653 6.23589 418.629 6.23589V2.2759H441.069L489.909 66.0319H490.569V23.2639C490.569 19.1279 490.305 15.8279 489.777 13.3639C489.249 10.8999 488.105 9.0959 486.345 7.9519C484.585 6.80789 481.813 6.23589 478.029 6.23589V2.2759H509.181V6.23589C505.837 6.23589 503.285 6.85189 501.525 8.08389C499.765 9.22789 498.577 11.1199 497.961 13.7599C497.433 16.3119 497.169 19.6999 497.169 23.9239V90.0559ZM449.517 88.9999H418.629V85.0399C422.149 85.0399 424.789 84.6879 426.549 83.9839C428.309 83.1919 429.497 81.6519 430.113 79.3639C430.729 77.0759 431.037 73.7319 431.037 69.3319V10.1959H437.505V69.3319C437.505 73.7319 437.813 77.0759 438.429 79.3639C439.045 81.5639 440.233 83.0599 441.993 83.8519C443.753 84.6439 446.261 85.0399 449.517 85.0399V88.9999Z"
          fill="currentColor"
        />
      </svg>
      <h1 class="hidden">Gauken</h1>
    </NuxtLink>
    <div v-if="isHome" class="grid lg:grid-cols-12 grid-cols-4">
      <NuxtLink
        to="/work"
        class="col-start-1 col-span-12 lg:col-start-3 lg:col-span-4"
        >see all
        <ClientOnly>
          <span v-if="random_art_piece" class="p-1"
            ><NuxtImg
              format="avif"
              :src="random_art_piece.data.artwork.url ?? ''"
              class="inline-block"
              height="40"
              sizes="sm:40px md:40px lg:40px"
              quality="70"
              :alt="
                random_art_piece.data.artwork.alt ||
                `Artwork by ${random_art_piece.data.title || 'David Wilson'}`
              "
              placeholder
            />
          </span>
        </ClientOnly>
        work
        <sup class="text-xs"> [{{ art_piece_count }}]</sup>
        â†’</NuxtLink
      >
    </div>
  </div>
</template>
